# LoadBalancer
Распределитель нагрузки

Задача:
Написать веб-сервис, распределяющий нагрузку между N веб сервисами равномерно. Если один из веб сервисов перестает отвечать, то исключить его из массива веб сервисов и распределять нагрузку между N-1 сервисами. 
Нагрузкой для каждого сервиса является количество запросов, находящихся у него в обработке. Относительно этого числа распределение должно быть равномерным. 

На выходе у вас должен получиться HTTP прокси сервер, который равномерно распределит нагрузку между N сервисами. 


Требования к ЯП: -

Требования к развертке: Docker

Требования к конфигурации: список веб сервисов с их адресами прописать в отдельном конфигурационном файле. 


Шаги тестирования: 

1)Поднять минимум 5 сервисов таргетов 

2)Поднять сервис распределитель 

3)Запустить скрипт спама запросами 

4)Каждые 10 секунд каждый из сервисов-таргетов должен логировать текущее количество запросов в обработке 

5)На 100-ой секунде отключить один из сервисов-таргетов 

6)На 200-ой включить его обратно 

По итогу тестирования лог файлы таргетов должны свидетельствовать о равномерном распределении нагрузки, в момент отключения таргета n, таргеты N-1 должны разделить между собой нагрузку. В момент включения таргета n, таргеты N должны освободить часть нагрузки под поднявшийся таргет.


# Реализованные стратегии балансировки

Round Robin - передача запросов каждому сервису по очереди

Round Robin Wieghted - как и RoundRobin, но с учетом, что сервисы имеют разную "мощность"

Least Connections - распределение нагрузки между сервсисами равномерно


# Описание файлов

client - посылает запросы на порт 8080

example - в этой папке лежат конфиг файлы, при запуске main функции параметром надо передавать один из конфиг файлов. В данном проекте 3 конфиг файла, так как реализовано 3 стратегии балансировки нагрузки, можно выбрать конфиг файл по желанию. (в docker compose прописано выбрать конфиг со стратегией least connections)

pkg - здесь лежат пакеты, которые используются для работы программы. В частности config - для загрузки конфиг файла, domain - структуры сервер, сервис и их методы, 
health - healthchecker, strategy - стратегии балансировки

server - простой сервер для приема запросов от балансировщика, в качестве параметра передается порт

main.go - в качестве параметра передается конфиг файл. Создает балансировщик и начинает пытаться подключиться к сервисам, указанным в конфиг файле, так же запускает healthchecker.
